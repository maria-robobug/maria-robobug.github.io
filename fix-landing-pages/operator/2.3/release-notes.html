<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Release Notes for Couchbase Autonomous Operator 2.3 | Couchbase Docs (Local)</title>
<link rel="canonical" href="https://maria-robobug.github.io/operator/2.3/release-notes.html">
<link rel="stylesheet" href="../../_/css/site.css">
<script src="../../_/js/vendor/jquery.js"></script>
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="operator">
<meta name="dcterms.identifier" content="2.3">
<meta name="page-url" content="/operator/2.3/release-notes.html">
<meta name="generator" content="Antora 3.0.1">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://maria-robobug.github.io/home/index.html">
                    <img src="../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://maria-robobug.github.io/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../cloud-native-database/index.html">
                      Cloud-Native
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="1">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/mariashodunke/Couchbase/docs/couchbase-operator/docs/user/modules/ROOT/pages/release-notes.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="overview.html">Autonomous Operator</a></li>
<li class="crumb">Release Notes</li>
<li class="crumb"><a href="release-notes.html">Release Notes</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Release Notes for Couchbase Autonomous Operator 2.3</h1>
</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Couchbase Autonomous Operator 2.3 is a significant release that expands support for
Couchbase Server 7, providing full support for scope and collections.</p>
</div>
<div class="paragraph">
<p>Take a look at the <a href="whats-new.html" class="xref page">What&#8217;s New</a> page for a list of new features and improvements that are available in this release.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation"><a class="anchor" href="#installation"></a>Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For installation instructions, refer to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="install-kubernetes.html" class="xref page">Install the Operator on Kubernetes</a></p>
</li>
<li>
<p><a href="install-openshift.html" class="xref page">Install the Operator on OpenShift</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="upgrading-to-autonomous-operator-2-3"><a class="anchor" href="#upgrading-to-autonomous-operator-2-3"></a>Upgrading to Autonomous Operator 2.3</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The necessary steps needed to upgrade to this release depend on which version of the Autonomous Operator you are upgrading from.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Version 1.x.x</p>
<div class="ulist">
<ul>
<li>
<p>There is no direct upgrade path from versions prior to 2.0.x.
To upgrade from a 1.x.x release, you must first upgrade to 2.0.x, paying particular attention to supported Kubernetes platforms and Couchbase Server versions.
Refer to the <a href="#2.0@operator::howto-operator-upgrade.adoc" class="xref unresolved">2.0.x upgrade steps</a> if upgrading from a 1.x.x release.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Version 2.0.x</p>
<div class="ulist">
<ul>
<li>
<p>Additional steps and considerations are required when upgrading from version 2.0.x.
Please refer to <a href="#upgrade-v20x">Upgrading from Version 2.0.x</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Version 2.1.x</p>
<div class="ulist">
<ul>
<li>
<p>There are no additional upgrade steps or considerations when upgrading from this version.
You may follow <a href="howto-operator-upgrade.html" class="xref page">standard upgrade process</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Version 2.2.x</p>
<div class="ulist">
<ul>
<li>
<p>There are no additional upgrade steps or considerations when upgrading from this version.
You may follow <a href="howto-operator-upgrade.html" class="xref page">standard upgrade process</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="upgrade-v20x"><a class="anchor" href="#upgrade-v20x"></a>Upgrading from Version 2.0.x</h3>
<div class="paragraph">
<p>First, ensure that you are running <a href="prerequisite-and-setup.html" class="xref page">compatible versions</a> of Kubernetes and Couchbase Server before upgrading.</p>
</div>
<div class="sect3">
<h4 id="tls-requirements"><a class="anchor" href="#tls-requirements"></a>TLS Requirements</h4>
<div class="paragraph">
<p>If you are <strong>not</strong> utilizing TLS, you can skip this section.</p>
</div>
<div class="paragraph">
<p>The TLS requirements have been modified as of Autonomous Operator 2.1.
In order to ease the migration from legacy client bootstrap (CCCP) to the newest version (GCCCP), the Autonomous Operator requires Couchbase cluster subject alternative names (SANs) to be updated.
Consult the <a href="tutorial-tls.html" class="xref page">TLS tutorial</a> for a full list of all the required SANs, and the <a href="howto-tls-rotation.html" class="xref page">TLS rotation guide</a> in order to prepare for upgrade.
Failure to perform this step will result in errors from the dynamic admission controller (DAC) once upgraded.</p>
</div>
</div>
<div class="sect3">
<h4 id="mandatory-couchbase-upgrade-cycle"><a class="anchor" href="#mandatory-couchbase-upgrade-cycle"></a>Mandatory Couchbase Upgrade Cycle</h4>
<div class="paragraph">
<p>When upgrading from version 2.0.x, Couchbase clusters will undergo a mandatory upgrade cycle.</p>
</div>
<div class="paragraph">
<p>Pod readiness checks were previously driven by an <code>exec</code> based readiness probe.
This was a security concern because it granted the Autonomous Operator <code>pods/exec</code> privileges, which may not be acceptable in highly regulated environments.
As of Autonomous Operator 2.1, readiness checks are performed using readiness gates that use the Kubernetes API exclusively.</p>
</div>
<div class="paragraph">
<p>You can use the <a href="resource/couchbasecluster.html#couchbaseclusters-spec-rollingupgrade" class="xref page"><code>couchbaseclusters.spec.rollingUpgrade</code></a> configuration parameter to speed up this upgrade.
To enable this feature while upgrading the Autonomous Operator, stop the old Operator, replace the CRDs, edit the <a href="resource/couchbasecluster.html#couchbaseclusters-spec-rollingupgrade" class="xref page"><code>couchbaseclusters.spec.rollingUpgrade</code></a> field to enable bulk upgrades, then start the new Operator.
Refer to <a href="howto-operator-upgrade.html" class="xref page">Upgrade the Operator</a> for further details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="upgrading-from-2-0-2-1-and-2-2"><a class="anchor" href="#upgrading-from-2-0-2-1-and-2-2"></a>Upgrading from 2.0, 2.1, and 2.2</h3>
<div class="sect3">
<h4 id="mandatory-couchbase-upgrade-cycle-2"><a class="anchor" href="#mandatory-couchbase-upgrade-cycle-2"></a>Mandatory Couchbase Upgrade Cycle</h4>
<div class="paragraph">
<p>Some users will encounter a mandatory upgrade cycle when upgrading to this release.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>An upgrade cycle is a relatively heavyweight operation that requires all pods in the cluster to be replaced, and data transferred between the old and new pods.
The time taken to perform this operation is dependent on network bandwidth, disk IO and the amount of data resident in the database.
For large, production databases, ensure an adequate maintenance window is scheduled as to minimize any disruption to clients and other business critical functions.</p>
</div>
<div class="paragraph">
<p>For further information read the <a href="concept-upgrade.html" class="xref page">Couchbase Upgrade</a> concepts page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="tls-users"><a class="anchor" href="#tls-users"></a>TLS Users</h5>
<div class="paragraph">
<p>In prior versions, Couchbase Server pod readiness checks were done over plain text port 8091.
With the introduction of strict mode TLS in this release, port 8091 can be disabled to inhibit all non TLS ports.
The Operator has been updated to use port 18091&#8201;&#8212;&#8201;Couchbase Server&#8217;s TLS admin port&#8201;&#8212;&#8201;when TLS management is enabled.</p>
</div>
</div>
<div class="sect4">
<h5 id="server-groups-users"><a class="anchor" href="#server-groups-users"></a>Server Groups Users</h5>
<div class="paragraph">
<p>A pod upgrade is also required for users of the server groups feature.</p>
</div>
<div class="paragraph">
<p>When the Operator was first released, the only available Node label that was available across all platforms to allow explicit pod scheduling was <code>failure-domain.beta.kubernetes.io/zone</code>.
This label has been deprecated since Kubernetes 1.17, in favor of <code>topology.kubernetes.io/zone</code>.</p>
</div>
<div class="paragraph">
<p>To ensure correct operation of the Operator in the future, the decision has been taken to start using the new label as of Operator 2.3.
This ensures that the Operator is compatible with all future Kubernetes releases in the event of the deprecated label being removed.</p>
</div>
</div>
<div class="sect4">
<h5 id="logging-users"><a class="anchor" href="#logging-users"></a>Logging Users</h5>
<div class="paragraph">
<p>To control memory usage, memory buffer limits have been implemented for the logging sidecar.
This change will affect all users of logging, and will require a cluster upgrade.</p>
</div>
<div class="paragraph">
<p>Additionally a bug in the audit clean up script caused old logs to be deleted only if their age matched the specified time period exactly.
This has been fixed so that logs older than or equal to the time period are cleaned.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="release-v230"><a class="anchor" href="#release-v230"></a>Release 2.3.0</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Couchbase Autonomous Operator 2.3.0 was released in April 2022.</p>
</div>
<div class="sect2">
<h3 id="changes-in-behavior-v230"><a class="anchor" href="#changes-in-behavior-v230"></a>New Features and Behavioral Changes</h3>
<div class="sect3">
<h4 id="data-topology-synchronization"><a class="anchor" href="#data-topology-synchronization"></a>Data Topology Synchronization</h4>
<div class="paragraph">
<p>This feature allows manually created buckets, scopes and collections to be synchronized as Kubernetes primitives and then managed.</p>
</div>
<div class="paragraph">
<p>For more information, see the <a href="concept-data-save-restore.html" class="xref page">Data Topology Save, Restore and Synchronization</a> concepts page.</p>
</div>
</div>
<div class="sect3">
<h4 id="data-topology-save-and-restore"><a class="anchor" href="#data-topology-save-and-restore"></a>Data Topology Save and Restore</h4>
<div class="paragraph">
<p>This feature allows manually created buckets, scopes and collections to be saved, then restored to any cluster.
Unlike synchronization, this feature supports partial save and restore, different merge policies, resource compaction and garbage collection.</p>
</div>
<div class="paragraph">
<p>For more information, see the <a href="concept-data-save-restore.html" class="xref page">Data Topology Save, Restore and Synchronization</a> concepts page.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="known-issues"><a class="anchor" href="#known-issues"></a>Known Issues</h3>
<table id="table_known_issues" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 27.4725%;">
<col style="width: 72.5275%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://issues.couchbase.com/browse/K8S-2690">K8S-2690</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>Summary</strong>:
Kubernetes resource names are based on DNS, and may be up to ~250 characters in length.
Prior to Couchbase Server <code>6.6.5</code> and <code>7.0.0</code>, host names were used to generate a key for internal communication, however, long names caused a buffer overflow.</p>
</div>
<div class="paragraph">
<p>This was fixed in <code>6.6.5</code> (though not fully implemented for Eventing) and <code>7.0.0</code>.
When using long namespaces or cluster names, ensure that you use a version of Couchbase Server greater than <code>6.6.5</code> or <code>7.0.0</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://issues.couchbase.com/browse/K8S-2698">K8S-2698</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>Summary</strong>:
The restore process can determine what repository to use in a <code>CouchbaseBackupRestore</code> resource, and therefore the <code>repo</code> field <em>should</em> be entirely optional.
However, the underlying API erroneously requires this field to be set.</p>
</div>
<div class="paragraph">
<p>To avoid any errors, we recommend setting the <code>repo</code> field to an empty string until the issue is fixed in a future release.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: couchbase.com/v2
kind: CouchbaseBackupRestore
spec:
  repo: ""</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://issues.couchbase.com/browse/K8S-2713">K8S-2713</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>Summary</strong>:
Due to a mismatch between the catalog version of our backup image and the version recommended by the certification tool, you will need to override the default backup used for certification with OpenShift.
The override can be provided via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$  cao certify -- -backup-image registry.connect.redhat.com/couchbase/operator-backup:1.3.0-2</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://issues.couchbase.com/browse/K8S-2676">K8S-2676</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>Summary</strong>:
Currently, it is not possible to specify a raw IPv6 Address for XDCR.<br>
This will be fixed in the next Operator release, and will include an update to the CRD.
As a workaround to support XDCR to an IPv6 endpoint, you will need to remove the XDCR hostname rules from the <code>CouchbaseCluster</code> custom resource.</p>
</div>
<div class="paragraph">
<p>Run the <code>kubectl edit</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ kubectl edit crd couchbaseclusters.couchbase.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, remove <code>pattern</code> from the yaml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">xdcr:
  hostname:
    description: Hostname is the connection string to use to connect the remote cluster.
    pattern: ^((couchbase|couchbases|http|https)://)?[0-9a-zA-Z\-\.]+(:\d+)?(\?network=[^&amp;]+)?$</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that removing <code>pattern</code> will disable any validation on this field (i.e. if an invalid hostname is provided it won&#8217;t be validated).
Contact the <a href="https://support.couchbase.com">Couchbase Support team</a> for further help on this workaround.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://issues.couchbase.com/browse/K8S-2717">K8S-2717</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>Summary</strong>:
At this point in time, you cannot set the storage class used for the artifact logs during certification.
This means the <code>default</code> storage class is always used when running the <code>cao certify</code> command.<br>
Passing the <code>-storage-class</code> flag to the command will only affect volumes created during test, but <strong>not</strong> the volume used to store test results.</p>
</div>
<div class="paragraph">
<p>If you need to use a specific type of storage class for both artifacts and testing, please contact the <a href="https://support.couchbase.com">Couchbase Support team</a> for advice on a workaround.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="release-v230-beta1"><a class="anchor" href="#release-v230-beta1"></a>Release 2.3.0-beta1</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Couchbase Autonomous Operator 2.3.0-beta1 was released in October 2021.</p>
</div>
<div class="sect2">
<h3 id="changes-in-behavior-v230-beta1"><a class="anchor" href="#changes-in-behavior-v230-beta1"></a>New Features and Behavioral Changes</h3>

</div>
<div class="sect2">
<h3 id="logging-defaults"><a class="anchor" href="#logging-defaults"></a>Logging Defaults</h3>
<div class="paragraph">
<p>The new default image for logging is <code>couchbase/fluent-bit:1.1.1</code>.
This image features functional and security updates.</p>
</div>
<div class="paragraph">
<p>Existing clusters will continue to use the logging version they were provisioned with.
Should you wish to update existing Couchbase clusters to make use of this new image, then they will undergo a rolling upgrade to facilitate the update.
You should plan a maintenance window accordingly.</p>
</div>
<div class="sect3">
<h4 id="scopes-and-collections-management"><a class="anchor" href="#scopes-and-collections-management"></a>Scopes and Collections Management</h4>
<div class="paragraph">
<p>The Operator now has the ability to fully manage scopes and collections within a bucket.
Scopes and collections provide fine grained access control and replication, and improved scalability.</p>
</div>
<div class="paragraph">
<p>For further information consult the <a href="concept-scopes-and-collections.html" class="xref page">Scopes and Collections Concepts</a> documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="backup-and-restore-improvements"><a class="anchor" href="#backup-and-restore-improvements"></a>Backup and Restore Improvements</h4>
<div class="paragraph">
<p>Due to interface changes introduced in Couchbase Server 7.0, a new backup image (1.2.0) is the only supported version that will run with Operator 2.3.
It continues to support operation with all supported Couchbase Server versions.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ensure that any backup jobs are upgraded to use the new image when moving to Operator 2.3.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Backup 1.2.0 fully supports operation with Couchbase scopes and collections.
Additional improvements include support for filtering of backup source data&#8201;&#8212;&#8201;thus minimizing backup size and improving performance, and the addition of new options for filtering restore data&#8201;&#8212;&#8201;such as with document key and value regular expressions.</p>
</div>
</div>
<div class="sect3">
<h4 id="removal-of-admission-controller-mutation"><a class="anchor" href="#removal-of-admission-controller-mutation"></a>Removal of Admission Controller Mutation</h4>
<div class="paragraph">
<p>Prior to this release, the dynamic admission controller was utilized to provide some defaults to Couchbase custom resources.
The vast majority of these defaults have already been migrated to native CRD defaulting.
Mutation has now been fully removed to provide out-of-the-box compatibility with platforms like GKE Autopilot where mutation is prohibited.</p>
</div>
<div class="paragraph">
<p>Some defaults were not able to be migrated so have been removed entirely:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Default file system groups for persistent volumes (does not affect Red Hat OCP).
When using Couchbase with PVCs, the operator tries to reuse data where possible.
In order for an old volume to be used by a new pod, the data needs to be read and written by the same group across all pods.
Clusters that use backups are also affected, as these reuse PVCs across backup jobs.</p>
<div class="paragraph">
<p>Previously the DAC provided dynamic defaults depending on the platform (Kubernetes/Red Hat OCP).
While OCP should work without specifying the file system group, Kubernetes users will need to explicitly specify the group when using persistent volumes.
Follow the existing <a href="concept-persistent-volumes.html#using-storage-classes" class="xref page">persistent volume concepts</a> documentation for guidance on configuration.</p>
</div>
</li>
<li>
<p>Backup and Prometheus images.
These were dynamically populated by the DAC for ease of use, depending on platform.
These fields are now marked as required to be provided by the end user.
Up to date images can be found on Docker hub and the Red Hat container catalog.
See the <a href="prerequisite-and-setup.html" class="xref page">prerequisites</a> documentation for compatible image versions.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="tooling-updates"><a class="anchor" href="#tooling-updates"></a>Tooling Updates</h4>
<div class="paragraph">
<p>Previous releases came bundled with <code>cbopcfg</code> and <code>cbopinfo</code> binaries to aid installation and support requests respectively.
While these binaries are still part of the distribution, the new <a href="tools/cao.html" class="xref page"><code>cao</code></a> binary features all the existing functionality of these tools, and extends the feature set to allow self-service platform certification.
The existing <code>cbopcfg</code> and <code>cbopinfo</code> binaries are now deprecated and will be removed in a later release.</p>
</div>
<div class="paragraph">
<p>You should update any tooling to use <code>cao</code>, or you can alias existing commands to use the new binary:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ alias cbopcfg='cao'
$ alias cbopinfo='cao collect-logs'</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fixed-issues-v230-beta1"><a class="anchor" href="#fixed-issues-v230-beta1"></a>Fixed Issues</h3>
<table id="table-fixed-issues-v230-beta1" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 27.4725%;">
<col style="width: 72.5275%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://issues.couchbase.com/browse/K8S-2432" target="_blank" rel="noopener">K8S-2432</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>Summary:</strong> When recovering a pod and using persistent volume storage, there is the possibly of a race condition when running the Couchbase Server pod&#8217;s initialization container.
This occurs when the underlying storage provider returns an error, rather than a definitive answer a to whether a file exists.
The error appears as if the file doesn&#8217;t exist, and so the container erroneously reinitializes its persistent storage and resets configuration, particularly storage path locations.
This fix removes the condition check, and replaces with a non-destructive copy instead.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://issues.couchbase.com/browse/K8S-2534" target="_blank" rel="noopener">K8S-2534</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>Summary:</strong> Couchbase Cluster becomes inoperable when its internal replication streams are longer than 200 Characters.
This occurs when Operator is installed with Couchbase Server version 6.6.3 and below and is caused by runtime validation checks made by Couchbase Server against internal replication streams.
The fix is made to Couchbase Server 6.6.4 and 7.0.x.
Also, the Couchbase Helm Chart has been improved to shorten the default cluster name in order to prevent the creation of clusters with long names.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="feedback"><a class="anchor" href="#feedback"></a>Feedback</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can have a big impact on future versions of the Operator (and its documentation) by providing Couchbase with your direct feedback and observations. Please feel free to post your questions and comments to the <a href="https://forums.couchbase.com/c/couchbase-server/Kubernetes">Couchbase Forums</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="licenses-for-third-party-components"><a class="anchor" href="#licenses-for-third-party-components"></a>Licenses for Third-Party Components</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The complete list of licenses for Couchbase products is available on the <a href="https://www.couchbase.com/legal/agreements">Legal Agreements</a> page. Couchbase is thankful to all of the individuals that have created these third-party components.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="more-information"><a class="anchor" href="#more-information"></a>More Information</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="../../server/7.1/release-notes/relnotes.html" class="xref page">Couchbase Server Release Notes</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2022 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Autonomous Operator","components":["operator"],"latestVersions":{"operator":"2.3"}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../_/js/site.js"></script>
<script defer src="../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
</body>
</html>
